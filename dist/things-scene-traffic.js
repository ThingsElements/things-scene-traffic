!function(t){var e={};function a(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=e,a.d=function(t,e,r){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(r,i,function(e){return t[e]}.bind(null,i));return r},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=1)}([function(t,e){t.exports=scene},function(t,e,a){t.exports=a(2)},function(t,e,a){"use strict";a.r(e);var r=a(0);const i={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"color",label:"Ray color",name:"rayColor"}]};class n{constructor(t,e,a){this.id=t,this.startedAt=Date.now(),this.ttl=a;var r=Math.random()*Math.PI*2;this.line={x1:0,y1:0,x2:0+e*Math.cos(r),y2:0+e*Math.sin(r)}}get endedAt(){return this.startedAt+this.ttl}end(){this.ended=!0}get ray(){var t=Date.now(),e=this.startedAt,a=(t-e)/(this.endedAt-e);this.ended&&(a=Math.min(1,this.lastRatio+.05)),this.lastRatio||(this.lastRatio=0);var{x1:r,y1:i,x2:n,y2:s}=this.line,o={x1:r+(n-r)*this.lastRatio,y1:i+(s-i)*this.lastRatio,x2:r+(n-r)*a,y2:i+(s-i)*a};return this.lastRatio=a,o}}class s extends(Object(r.RectPath)(r.Shape)){dispose(){this._rap&&(cancelAnimationFrame(this._rap),delete this._rap),super.dispose()}ready(){this._rap=requestAnimationFrame(()=>{this.ready()}),this.invalidate()}get rays(){return this._rays||(this._rays={}),this._rays}cometCreated(t,e){this.rays[t]=e}cometDestroyed(t){var e=this.rays[t];e&&e.end()}_draw(t){var{top:e,left:a,height:r,width:i}=this.bounds,{x:n,y:s}=this.center;t.beginPath(),t.fillStyle=this.getState("fillStyle")||"black",t.rect(a,e,i,r),t.clip(),t.fill(),t.lineCap="round";Date.now();Object.values(this.rays).forEach(e=>{let a=e.ray;if(!e.ended&&e.lastRatio>=1)return void delete this.rays[e.id];let r=Math.round(10*e.lastRatio),i=this.getState("rayColor")||"#5577aa";if(!e.ended){i=`#${Math.round(255*e.lastRatio).toString(16).padStart(2,"0")}2233`}t.save(),t.beginPath(),t.lineWidth=1+r/(e.ended?3:1),t.strokeStyle=i,t.globalAlpha=e.lastRatio%1,t.moveTo(n+a.x1,s+a.y1),t.lineTo(n+a.x2,s+a.y2),t.stroke(),t.restore(),e.ended&&e.lastRatio>=1&&delete this.rays[e.id]})}_post_draw(){}get controls(){}get nature(){return i}handleQueueIn(t){var{id:e,ttl:a,intime:r}=t,{width:i,height:s}=this.bounds;this.cometCreated(e,new n(e,Math.sqrt(i*i+s*s)/3,a))}handleConsume(t){var{id:e}=t;this.cometDestroyed(e)}handleTimeout(){}onchangeData(t,e){var{data:a}=t;a&&(!a instanceof Array&&(a=[a]),a.forEach(t=>{switch(t.type){case"publish":this.handleQueueIn(t);break;case"consume":this.handleConsume(t);break;case"timeout":this.handleTimeout(t)}}),this.invalidate())}onchange(t,e){}}r.Component.register("traffic-galaxy",s),a.d(e,"TrafficGalaxy",function(){return s})}]);
//# sourceMappingURL=things-scene-traffic.js.map